# AWS VPCハンズオン

## 📦 事前準備
なし


## 🛠 セットアップ手順

### 1. VPC内リソース作成

1. コンソールの検索欄に「VPC」と入力して、VPCコンソールに遷移する。<br><br>
2. 「VPCを作成」クリックする。<br><br>
3. **作成するリソース**で「VPCなど」を選択する。  
　💡右のプレビューで作成されるネットワーク内の構成が見れます！<br><br>
4. 以下の設定をして「VPCを作成」をクリックする。<br>
   ```
   AZの数: 1  
   VPC エンドポイント: なし
   ```
5. 完成！

### 2. EC2配置
🌟EC2インスタンスを作成して各サブネットに配置してみる
1. コンソールの検索欄に「EC2」と入力して、EC2コンソールに遷移する。<br><br>
2. [第一回](https://github.com/bigdragon0610/jr-champions-ec2-tutorial?tab=readme-ov-file#aws%E3%82%B3%E3%83%B3%E3%82%BD%E3%83%BC%E3%83%AB%E3%81%8B%E3%82%89ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B)の「AWSコンソールからEC2インスタンスを作成する」セクションを参考に、2つインスタンスを作成してみましょう！
   以下の項目だけ上記から変更してください。<br><br>
   パブリックサブネットに配置するEC2：<br>
   ```
   ネットワーク設定
   ・VPC：先程作成したVPC
   ・サブネット：「プロジェクト-subnet-public1」
   ・パブリックIPの自動割り当て：有効化
   ```
   プライベートサブネットに配置するEC2：<br>
   ```
   ネットワーク設定
   ・VPC：先程作成したVPC
   ・キーペア：パブリックサブネットに配置したEC2とは別に作成
   ・サブネット：「プロジェクト-subnet-private1」
   ・パブリックIPの自動割り当て：無効化
   ・インバウンドセキュリティグループのルール：
   　　・タイプ→ssh
   　　・ソースタイプ→任意の場所
   　　・ソース：パブリックサブネットに配置したEC2のセキュリティグループ
   ```

### 3. EC2接続確認
[第一回](https://github.com/bigdragon0610/jr-champions-ec2-tutorial?tab=readme-ov-file#ec2%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%ABssh%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B)の「EC2インスタンスにSSH接続する」セクションを参考に、各インスタンスにアクセスしてみましょう！  <br>
※プライベートサブネットの方はパブリックIPv4アドレスが設定されていないため、プライベートIPv4アドレスで試してみてください。<br>
パブリックサブネットのインスタンスにのみアクセスができて、プライベートサブネットのインスタンスへのアクセスが失敗したらOKです！

### 4. プライベートサブネットインスタンスに接続する
1. パブリックサブネットのEC2インスタンスに、プライベートサブネットのEC2インスタンスのpemファイルをコピーする  
   ※この時、パブリックサブネットのEC2インスタンスに接続している場合はローカル環境に戻る
   ```bash
   scp -i <パブリックサブネットのEC2インスタンスのpemファイル> <プライベートサブネットのEC2インスタンスのpemファイル> ec2-user@<パブリックサブネットのパブリックIPv4アドレス>:~/
   ```
2. パブリックサブネットのEC2インスタンスにssh接続する
   ```bash
   ssh -i <パブリックサブネットのEC2インスタンスのpemファイル> ec2-user@<パブリックサブネットのパブリックIPv4アドレス>
   ```
3. プライベートサブネットのEC2インスタンスにssh接続する
   ```bash
   ssh -i <プライベートサブネットのEC2インスタンスのpemファイル名> ec2-user@<プライベートサブネットのEC2インスタンスのpemファイル名>
   ```
接続できたら成功です🎉

## お片付け
VPC・EC2インスタンスは削除しておきましょう！
VPCを削除すると、中にあるサブネット等は一緒に削除されます。
